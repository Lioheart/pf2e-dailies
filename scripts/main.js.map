{"mappings":"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","sources":["src/main.ts","../../../../Projects/foundry-ts/utils/foundry/settings.ts","src/module.ts","../../../../Projects/foundry-ts/utils/foundry/path.ts","src/sheet.ts","../../../../Projects/foundry-ts/utils/foundry/i18n.ts","src/apps/app.ts","../../../../Projects/foundry-ts/utils/foundry/flags.ts","../../../../Projects/foundry-ts/utils/foundry/notifications.ts","../../../../Projects/foundry-ts/utils/pf2e.ts","../../../../Projects/foundry-ts/utils/set.ts","src/feats.ts","src/helpers.ts","../../../../Projects/foundry-ts/utils/foundry/uuid.ts","src/warning.ts","../../../../Projects/foundry-ts/utils/foundry/hook.ts"],"sourcesContent":["import { getSetting, registerSetting } from './@utils/foundry/settings'\r\nimport { onRenderCharacterSheetPF2e } from './sheet'\r\nimport { setWarning } from './warning'\r\n\r\nHooks.on('renderCharacterSheetPF2e', onRenderCharacterSheetPF2e)\r\n\r\nHooks.once('init', () => {\r\n    registerSetting({\r\n        name: 'warning',\r\n        type: Boolean,\r\n        default: true,\r\n        scope: 'client',\r\n        config: true,\r\n        onChange: setWarning,\r\n    })\r\n})\r\n\r\nHooks.once('ready', () => {\r\n    if (getSetting<boolean>('warning')) {\r\n        setTimeout(() => setWarning(true), 2000)\r\n    }\r\n})\r\n","import MODULE_ID from '~./src/module'\r\nimport { getSettingLocalizationPath } from './path'\r\n\r\nexport function getSetting<T extends any>(key: string) {\r\n    return game.settings.get(MODULE_ID, key) as T\r\n}\r\n\r\nexport function setSetting(key: string, value: unknown) {\r\n    return game.settings.set(MODULE_ID, key, value)\r\n}\r\n\r\n/**\r\n * options.scope = 'world'\r\n *\r\n * options.config = false\r\n */\r\nexport function registerSetting(\r\n    options: Omit<SettingRegistration, 'choices'> & { choices?: string[] | Record<string, unknown> }\r\n) {\r\n    const name = options.name\r\n    options.scope = options.scope ?? 'world'\r\n    options.config = options.config ?? false\r\n    if (options.config) {\r\n        options.name = getSettingLocalizationPath(name, 'name')\r\n        options.hint = getSettingLocalizationPath(name, 'hint')\r\n    }\r\n    if (Array.isArray(options.choices)) {\r\n        options.choices = options.choices.reduce((choices, choice) => {\r\n            choices[choice] = getSettingLocalizationPath(name, 'choices', choice)\r\n            return choices\r\n        }, {} as Record<string, unknown>)\r\n    }\r\n    game.settings.register(MODULE_ID, name, options as SettingRegistration)\r\n}\r\n\r\n/**\r\n * options.restricted = true\r\n *\r\n * options.icon = 'fas fa-cogs'\r\n */\r\nexport function registerSettingMenu(\r\n    options: RequiredBy<Partial<Omit<SettingSubmenuConfig, 'type'>>, 'name'> & { type: ConstructorOf<FormApplication> }\r\n) {\r\n    const name = options.name\r\n    options.name = getSettingLocalizationPath('menus', name, 'name')\r\n    options.label = getSettingLocalizationPath('menus', name, 'label')\r\n    options.hint = getSettingLocalizationPath('menus', name, 'hint')\r\n    options.restricted = options.restricted ?? true\r\n    options.icon = options.icon ?? 'fas fa-cogs'\r\n    game.settings.registerMenu(MODULE_ID, name, options as SettingSubmenuConfig)\r\n}\r\n\r\nexport function getCombatTrackerConfig() {\r\n    return game.settings.get('core', 'combatTrackerConfig') as { resource: string; skipDefeated: boolean }\r\n}\r\n","export default 'pf2e-dailies'\r\n","import MODULE_ID from '~./src/module'\r\n\r\nexport function getSettingLocalizationPath(...path: string[]) {\r\n    return `${MODULE_ID}.settings.${path.join('.')}`\r\n}\r\n\r\nexport function flagsUpdatePath(...path: string[]) {\r\n    return `flags.${MODULE_ID}.${path.join('/')}`\r\n}\r\n\r\nexport function templatePath(...path: string[]) {\r\n    path = path.filter(x => typeof x === 'string')\r\n    return `modules/${MODULE_ID}/templates/${path.join('/')}`\r\n}\r\n\r\nexport function imagePath(...path: string[]) {\r\n    return `modules/${MODULE_ID}/images/${path.join('/')}`\r\n}\r\n","import { subLocalize } from './@utils/foundry/i18n'\r\nimport { PF2eDailies } from './apps/app'\r\nimport { hasAnyFeat } from './feats'\r\n\r\nconst localize = subLocalize('sheet')\r\nconst feats: FeatGroups = [\r\n    ['scroll', 0],\r\n    ['talisman', 0],\r\n    ['trickster', 0],\r\n    ['dabbler', 0],\r\n]\r\n\r\nexport function onRenderCharacterSheetPF2e(sheet: CharacterSheetPF2e, html: JQuery) {\r\n    const actor = sheet.actor\r\n    if (!hasAnyFeat(actor, feats)) return\r\n\r\n    const title = localize('title')\r\n    const link = `<a class=\"roll-icon dailies\" title=\"${title}\"><i class=\"fas fa-mug-saucer\"></i></a>`\r\n    html.find('aside .sidebar .hitpoints .hp-small')\r\n        .append(link)\r\n        .find('.dailies')\r\n        .on('click', () => new PF2eDailies(actor).render(true))\r\n}\r\n","import MODULE_ID from '~./src/module'\r\n\r\nexport function localize(key: string, data?: Record<string, string | number>) {\r\n    key = `${MODULE_ID}.${key}`\r\n    if (data) return game.i18n.format(key, data)\r\n    return game.i18n.localize(key)\r\n}\r\n\r\nexport function subLocalize(subKey: string) {\r\n    const fn = (key: string, data?: Record<string, string | number>) => localize(`${subKey}.${key}`, data)\r\n    Object.defineProperty(fn, 'key', {\r\n        get() {\r\n            return subKey\r\n        },\r\n        enumerable: false,\r\n        configurable: false,\r\n    })\r\n    return fn as ((key: string, data?: Record<string, string | number>) => string) & { key: string }\r\n}\r\n","import { getFlag, setFlag } from '~src/@utils/foundry/flags'\r\nimport { subLocalize } from '~src/@utils/foundry/i18n'\r\nimport { warn } from '~src/@utils/foundry/notifications'\r\nimport { flagsUpdatePath, templatePath } from '~src/@utils/foundry/path'\r\nimport { getScrollCompendiumUUID } from '~src/@utils/pf2e'\r\nimport { hasAllFeats } from '~src/feats'\r\nimport { createMessage, isValidSpellType, isValidTalismanType } from '~src/helpers'\r\n\r\nconst localize = subLocalize('app')\r\n\r\nexport class PF2eDailies extends Application {\r\n    private _actor: CharacterPF2e\r\n\r\n    constructor(actor: CharacterPF2e) {\r\n        super({ id: `pf2e-dailies-${actor.id}` })\r\n        this._actor = actor\r\n    }\r\n\r\n    static get defaultOptions(): ApplicationOptions {\r\n        return mergeObject(super.defaultOptions, {\r\n            title: localize('title'),\r\n            template: templatePath('app.html'),\r\n            height: 'auto',\r\n            dragDrop: [\r\n                {\r\n                    dropSelector: '[name=\"spell\"], [name=\"talisman\"]',\r\n                },\r\n            ],\r\n        })\r\n    }\r\n\r\n    getData(options?: Partial<ApplicationOptions>) {\r\n        const actor = this._actor\r\n        const saved = getFlag<ItemFlags>(actor, 'saved') ?? ({} as ItemFlags)\r\n        const feats = hasAllFeats(actor)\r\n\r\n        return {\r\n            i18n: localize,\r\n            feats,\r\n            saved,\r\n            level: actor.level,\r\n            getTalismanValue: (values: ItemFlag[] | undefined, index: number, attr: 'name' | 'uuid') =>\r\n                values?.[index]?.[attr] ?? '',\r\n            getSpellValue: (values: ItemFlag[] | undefined, level: number, attr: 'name' | 'uuid') =>\r\n                values?.[level - 1]?.[attr] ?? '',\r\n            addOne: (v: number) => v + 1,\r\n        }\r\n    }\r\n\r\n    activateListeners(html: JQuery<HTMLElement>): void {\r\n        super.activateListeners(html)\r\n\r\n        html.find<HTMLAnchorElement>('[data-type=spell] [data-action=search]').on('click', this.#onSpellSearch.bind(this))\r\n        html.find<HTMLAnchorElement>('[data-type=talisman] [data-action=search]').on('click', this.#onTalismanSearch.bind(this))\r\n        html.find<HTMLAnchorElement>('[data-action=clear]').on('click', this.#onClear.bind(this))\r\n        html.find<HTMLButtonElement>('[data-action=accept]').on('click', this.#onAccept.bind(this))\r\n        html.find<HTMLButtonElement>('[data-action=cancel]').on('click', this.#onCancel.bind(this))\r\n    }\r\n\r\n    protected async _onDrop(event: ElementDragEvent) {\r\n        const dataString = event.dataTransfer?.getData('text/plain')\r\n        try {\r\n            const input = $(event.target)\r\n            const type = input.attr('name') as 'spell' | 'talisman'\r\n            const typeLabel = game.i18n.localize(type === 'spell' ? 'PF2E.SpellLabel' : 'PF2E.TraitTalisman').toLowerCase()\r\n            const typeError = () => warn('app.error.wrongType', { type: typeLabel })\r\n\r\n            const data: { type: string; uuid: string } = JSON.parse(dataString)\r\n            if (!data || data.type !== 'Item' || typeof data.uuid !== 'string') return typeError()\r\n\r\n            const typeValidation = type === 'spell' ? isValidSpellType : isValidTalismanType\r\n            const item = await fromUuid<ItemPF2e>(data.uuid)\r\n            if (!typeValidation(item)) return typeError()\r\n\r\n            const actor = this._actor\r\n            const maxLevel = type === 'spell' ? Number(input.attr('data-level')) : Math.floor(actor.level / 2)\r\n            if (item.level > maxLevel) return warn('app.error.wrongLevel', { type: typeLabel })\r\n\r\n            input.attr('value', item.name)\r\n            input.attr('data-uuid', item.uuid)\r\n            input.nextAll('[data-action=\"clear\"]').first().removeClass('disabled')\r\n        } catch {}\r\n    }\r\n\r\n    #onSpellSearch(event: JQuery.ClickEvent<any, any, HTMLAnchorElement>) {\r\n        event.preventDefault()\r\n\r\n        const level = Number(event.currentTarget.dataset.level)\r\n        const levels: number[] = []\r\n\r\n        for (let i = 0; i < level; i++) {\r\n            levels[i] = i + 1\r\n        }\r\n\r\n        const filter: InitialSpellFilters = {\r\n            category: ['spell'],\r\n            classes: [],\r\n            level: levels,\r\n            rarity: [],\r\n            school: [],\r\n            source: [],\r\n            traditions: [],\r\n            traits: [],\r\n        }\r\n\r\n        game.pf2e.compendiumBrowser.openTab('spell', filter)\r\n    }\r\n\r\n    #onTalismanSearch(event: JQuery.ClickEvent<any, any, HTMLAnchorElement>) {\r\n        const actor = this._actor\r\n\r\n        const filter: InitialEquipmentFilters = {\r\n            armorTypes: [],\r\n            weaponTypes: [],\r\n            itemtypes: ['consumable'],\r\n            rarity: [],\r\n            source: [],\r\n            traits: ['talisman'],\r\n            levelRange: { min: 1, max: Math.floor(actor.level / 2) },\r\n        }\r\n\r\n        game.pf2e.compendiumBrowser.openTab('equipment', filter)\r\n    }\r\n\r\n    #onClear(event: JQuery.ClickEvent<any, any, HTMLAnchorElement>) {\r\n        event.preventDefault()\r\n        const target = $(event.currentTarget)\r\n        const input = target.prevAll('[name=\"spell\"], [name=\"talisman\"]').first()\r\n        input.attr('value', '')\r\n        input.attr('data-uuid', '')\r\n        target.addClass('disabled')\r\n    }\r\n\r\n    #lock() {\r\n        this.element.find('button').attr('disabled', 'true')\r\n        this.element.find('a').addClass('disabled')\r\n    }\r\n\r\n    async #onAccept(event: JQuery.ClickEvent) {\r\n        event.preventDefault()\r\n        this.#lock()\r\n\r\n        const actor = this._actor\r\n        const flags = getFlag<ItemFlags>(actor, 'saved') ?? ({} as Partial<ItemFlags>)\r\n        const groups = {} as ItemFlags\r\n        const remove: ItemFlag[] = []\r\n        const add: (ItemFlag & { type: 'spell' | 'talisman'; level: OneToTen; category: FeatGroup })[] = []\r\n        let message = ''\r\n\r\n        this.element.find('.window-content .groups .group').each((_, el) => {\r\n            const group = $(el)\r\n            const category = group.attr('data-category') as FeatGroup\r\n\r\n            group.find<HTMLInputElement>('[name=\"spell\"], [name=\"talisman\"]').each((i, el) => {\r\n                const input = $(el)\r\n                const uuid = input.attr('data-uuid') as ItemUUID\r\n                const level = Number(input.attr('data-level') || 0) as OneToTen\r\n                const flag = flags[category]?.[i]\r\n                const hasItem = !!flag?.itemId && !!actor.items.has(flag.itemId)\r\n\r\n                let value: ItemFlag\r\n                if (flag?.uuid === uuid && hasItem) {\r\n                    value = flag\r\n                } else {\r\n                    const name = input.attr('value') as string\r\n                    const type = input.attr('name') as 'spell' | 'talisman'\r\n                    value = { name, uuid, itemId: uuid ? randomID() : '' }\r\n                    if (hasItem) remove.push({ name, uuid: flag.uuid, itemId: flag.itemId })\r\n                    if (uuid) add.push({ name, uuid, itemId: value.itemId, type, level, category })\r\n                }\r\n\r\n                groups[category] ??= []\r\n                groups[category][i] = value\r\n            })\r\n        })\r\n\r\n        if (remove.length) {\r\n            const ids = remove.map(x => x.itemId)\r\n            const items = await actor.deleteEmbeddedDocuments('Item', ids)\r\n            message += createMessage('remove', items, true)\r\n        }\r\n\r\n        if (add.length) {\r\n            const data: ConsumableSource[] = []\r\n            const scrolls: (ConsumablePF2e | null)[] = []\r\n\r\n            for (const entry of add) {\r\n                const uuid = entry.uuid\r\n                const level = entry.level\r\n                const category = localize(entry.category)\r\n                let item: ConsumableSource | undefined\r\n\r\n                if (entry.type === 'talisman') {\r\n                    item = (await fromUuid(uuid))?.toObject() as ConsumableSource\r\n                    if (!item) continue\r\n\r\n                    item.system.description.value = localize('item.talisman.description', {\r\n                        category,\r\n                        description: item.system.description.value,\r\n                    })\r\n                } else {\r\n                    const scrollUUID = getScrollCompendiumUUID(level)\r\n                    scrolls[level] ??= await fromUuid<ConsumablePF2e>(scrollUUID)\r\n\r\n                    const spell = await fromUuid<SpellPF2e>(uuid)\r\n                    item = scrolls[level]?.toObject() as unknown as ConsumableSource\r\n                    if (!item || !spell) continue\r\n\r\n                    item.name = localize('item.spell.name', { name: spell.name, level: level })\r\n                    item.system.spell = spell.clone({ 'system.location.heightenedLevel': level }).toObject() as SpellSource\r\n                    item.system.traits.value.push(...spell.traditions)\r\n                    item.system.description.value = localize('item.spell.description', {\r\n                        category,\r\n                        uuid: uuid,\r\n                        description: item.system.description.value,\r\n                    })\r\n                }\r\n\r\n                item.name = `${item.name} **`\r\n                setProperty(item, '_id', entry.itemId)\r\n                setProperty(item, flagsUpdatePath('temporary'), true)\r\n                data.push(item)\r\n            }\r\n\r\n            const items = await actor.createEmbeddedDocuments('Item', data, { keepId: true })\r\n            message += createMessage('add', items as ItemPF2e[])\r\n        }\r\n\r\n        setFlag(actor, 'saved', groups)\r\n\r\n        if (message) message = `${localize('message.changes')}<hr>${message}`\r\n        else message = localize('message.noChanges')\r\n        ChatMessage.create({ content: message, speaker: ChatMessage.getSpeaker({ actor }) })\r\n\r\n        this.close()\r\n    }\r\n\r\n    #onCancel(event: JQuery.ClickEvent) {\r\n        event.preventDefault()\r\n        this.close()\r\n    }\r\n}\r\n","import MODULE_ID from '~./src/module'\r\n\r\nexport function hasModuleFlag(doc: foundry.abstract.Document) {\r\n    // @ts-ignore\r\n    return !!doc.flags && MODULE_ID in doc.flags\r\n}\r\n\r\nexport function getFlag<T extends unknown>(doc: foundry.abstract.Document, key: string, ...keys: string[]) {\r\n    keys.unshift(key)\r\n    return doc.getFlag(MODULE_ID, keys.join('.')) as T | undefined\r\n}\r\n\r\n/**\r\n * @template {foundry.Document} T\r\n * @param {T} doc\r\n * @param {string} key\r\n * @param {any} value\r\n * @returns T\r\n */\r\nexport function setFlag(doc: foundry.abstract.Document, key: string, value: unknown) {\r\n    return doc.setFlag(MODULE_ID, key, value)\r\n}\r\n","import { localize } from './i18n'\r\n\r\nexport function notify(\r\n    str: string,\r\n    arg1?: 'warning' | 'info' | 'error' | boolean | Record<string, string>,\r\n    arg2?: boolean | Record<string, string>,\r\n    arg3?: boolean\r\n) {\r\n    const type = typeof arg1 === 'string' ? arg1 : 'info'\r\n    const data = typeof arg1 === 'object' ? arg1 : typeof arg2 === 'object' ? arg2 : undefined\r\n    const permanent = typeof arg1 === 'boolean' ? arg1 : typeof arg2 === 'boolean' ? arg2 : arg3 ?? false\r\n\r\n    ui.notifications.notify(localize(str, data), type, { permanent })\r\n}\r\n\r\nexport function warn(str: string, arg1?: boolean | Record<string, string>, arg2?: boolean) {\r\n    notify(str, 'warning', arg1, arg2)\r\n}\r\n\r\nexport function info(str: string, arg1?: boolean | Record<string, string>, arg2?: boolean) {\r\n    notify(str, 'info', arg1, arg2)\r\n}\r\n\r\nexport function error(str: string, arg1?: boolean | Record<string, string>, arg2?: boolean) {\r\n    notify(str, 'error', arg1, arg2)\r\n}\r\n","import { setHasElement } from './set'\r\n\r\nexport const PHYSICAL_ITEM_TYPES = new Set([\r\n    'armor',\r\n    'backpack',\r\n    'book',\r\n    'consumable',\r\n    'equipment',\r\n    'treasure',\r\n    'weapon',\r\n] as const)\r\n\r\nexport const dcByLevel = new Map([\r\n    [-1, 13],\r\n    [0, 14],\r\n    [1, 15],\r\n    [2, 16],\r\n    [3, 18],\r\n    [4, 19],\r\n    [5, 20],\r\n    [6, 22],\r\n    [7, 23],\r\n    [8, 24],\r\n    [9, 26],\r\n    [10, 27],\r\n    [11, 28],\r\n    [12, 30],\r\n    [13, 31],\r\n    [14, 32],\r\n    [15, 34],\r\n    [16, 35],\r\n    [17, 36],\r\n    [18, 38],\r\n    [19, 39],\r\n    [20, 40],\r\n    [21, 42],\r\n    [22, 44],\r\n    [23, 46],\r\n    [24, 48],\r\n    [25, 50],\r\n])\r\n\r\nexport const dcAdjustments = new Map([\r\n    ['incredibly easy', -10],\r\n    ['very easy', -5],\r\n    ['easy', -2],\r\n    ['normal', 0],\r\n    ['hard', 2],\r\n    ['very hard', 5],\r\n    ['incredibly hard', 10],\r\n])\r\n\r\nexport const MAGIC_TRADITIONS = new Set(['arcane', 'divine', 'occult', 'primal']) as Set<MagicTradition>\r\n\r\nexport function adjustDC(dc: number, adjustment: DCAdjustment = 'normal') {\r\n    return dc + (dcAdjustments.get(adjustment) ?? 0)\r\n}\r\n\r\nexport function rarityToDCAdjustment(rarity: Rarity = 'common'): PositiveDCAdjustment {\r\n    if (rarity === 'uncommon') return 'hard'\r\n    else if (rarity === 'rare') return 'very hard'\r\n    else if (rarity === 'unique') return 'incredibly hard'\r\n    else return 'normal'\r\n}\r\n\r\nexport function adjustDCByRarity(dc: number, rarity: Rarity = 'common') {\r\n    return adjustDC(dc, rarityToDCAdjustment(rarity))\r\n}\r\n\r\nexport function calculateDC(level: number, { proficiencyWithoutLevel = false, rarity = 'common' }: DCOptions = {}) {\r\n    // assume level 0 if garbage comes in. We cast level to number because the backing data may actually have it\r\n    // stored as a string, which we can't catch at compile time\r\n    const dc = dcByLevel.get(level) ?? 14\r\n    if (proficiencyWithoutLevel) {\r\n        // -1 shouldn't be subtracted since it's just\r\n        // a creature level and not related to PC levels\r\n        return adjustDCByRarity(dc - Math.max(level, 0), rarity)\r\n    } else {\r\n        return adjustDCByRarity(dc, rarity)\r\n    }\r\n}\r\n\r\n/** Extract all traits from an item, that match a magic tradition */\r\nfunction getMagicTraditions(item: PhysicalItemPF2e) {\r\n    const traits = item.system.traits.value\r\n    return new Set(traits.filter(t => setHasElement(MAGIC_TRADITIONS, t)))\r\n}\r\n\r\nexport function identifyMagic(item: PhysicalItemPF2e, baseDc: number, notMatchingTraditionModifier: number) {\r\n    const result = {\r\n        occult: baseDc,\r\n        primal: baseDc,\r\n        divine: baseDc,\r\n        arcane: baseDc,\r\n    }\r\n    const traditions = getMagicTraditions(item)\r\n    for (const key of MAGIC_TRADITIONS) {\r\n        // once an item has a magic tradition, all skills\r\n        // that don't match the tradition are hard\r\n        if (traditions.size > 0 && !traditions.has(key)) {\r\n            result[key] = baseDc + notMatchingTraditionModifier\r\n        }\r\n    }\r\n    return { arc: result.arcane, nat: result.primal, rel: result.divine, occ: result.occult }\r\n}\r\n\r\n/** All cursed items are incredibly hard to identify */\r\nexport function getDcRarity(item: PhysicalItemPF2e) {\r\n    return item.traits.has('cursed') ? 'unique' : item.rarity\r\n}\r\n\r\nexport function identifyItem(\r\n    item: PhysicalItemPF2e,\r\n    { proficiencyWithoutLevel = false, notMatchingTraditionModifier }: IdentifyItemOptions,\r\n    noDC = false\r\n) {\r\n    const baseDC = calculateDC(item.level, { proficiencyWithoutLevel })\r\n    const rarity = getDcRarity(item)\r\n    const dc = adjustDCByRarity(baseDC, rarity)\r\n    if (item.isMagical) return identifyMagic(item, dc, notMatchingTraditionModifier)\r\n    if (!noDC) return { cra: dc }\r\n    if (item.isAlchemical) return { cra: dc }\r\n    return { dc: dc }\r\n}\r\n\r\nexport function hasInvestedProperty(source: ItemSourcePF2e): source is MagicItemSource {\r\n    return isPhysicalData(source) && 'invested' in source.system.equipped\r\n}\r\n\r\n/** Checks if the given item data is a physical item with a quantity and other physical fields. */\r\nexport function isPhysicalData(source: ItemSourcePF2e): source is PhysicalItemSource\r\nexport function isPhysicalData(source: PreCreate<ItemSourcePF2e>): source is PreCreate<PhysicalItemSource>\r\nexport function isPhysicalData(source: ItemSourcePF2e | PreCreate<ItemSourcePF2e>): boolean {\r\n    return setHasElement(PHYSICAL_ITEM_TYPES, source.type)\r\n}\r\n\r\nexport function itemWithSource(actor: Actor, itemType: NON_PHYSICAL_ITEM_TYPE | PHYSICAL_ITEM_TYPES, id: string) {\r\n    return actor.itemTypes[itemType].find(x => x.getFlag('core', 'sourceId') === id)\r\n}\r\n\r\nexport const cantripDeckId = 'tLa4bewBhyqzi6Ow'\r\n\r\nexport const scrollCompendiumIds: Record<number, string> = {\r\n    1: 'RjuupS9xyXDLgyIr', // Compendium.pf2e.equipment-srd.RjuupS9xyXDLgyIr\r\n    2: 'Y7UD64foDbDMV9sx',\r\n    3: 'ZmefGBXGJF3CFDbn',\r\n    4: 'QSQZJ5BC3DeHv153',\r\n    5: 'tjLvRWklAylFhBHQ',\r\n    6: '4sGIy77COooxhQuC',\r\n    7: 'fomEZZ4MxVVK3uVu',\r\n    8: 'iPki3yuoucnj7bIt',\r\n    9: 'cFHomF3tty8Wi1e5',\r\n    10: 'o1XIHJ4MJyroAHfF',\r\n}\r\n\r\nconst wandCompendiumIds: Record<number, string> = {\r\n    1: 'UJWiN0K3jqVjxvKk',\r\n    2: 'vJZ49cgi8szuQXAD',\r\n    3: 'wrDmWkGxmwzYtfiA',\r\n    4: 'Sn7v9SsbEDMUIwrO',\r\n    5: '5BF7zMnrPYzyigCs',\r\n    6: 'kiXh4SUWKr166ZeM',\r\n    7: 'nmXPj9zuMRQBNT60',\r\n    8: 'Qs8RgNH6thRPv2jt',\r\n    9: 'Fgv722039TVM5JTc',\r\n}\r\n\r\nexport function getScrollCompendiumUUID(level: OneToTen): ItemUUID {\r\n    return `Compendium.pf2e.equipment-srd.${scrollCompendiumIds[level]}`\r\n}\r\n\r\nexport function getIdForSpellConsumable(type: 'cantripDeck5' | 'scroll' | 'wand', heightenedLevel: number): string | null {\r\n    switch (type) {\r\n        case 'cantripDeck5':\r\n            return cantripDeckId\r\n        case 'scroll':\r\n            return scrollCompendiumIds[heightenedLevel] ?? null\r\n        default:\r\n            return wandCompendiumIds[heightenedLevel] ?? null\r\n    }\r\n}\r\n","/** Check if an element is present in the provided set. Especially useful for checking against literal sets */\r\nexport function setHasElement<T extends Set<unknown>>(set: T, value: unknown): value is SetElement<T> {\r\n    return set.has(value)\r\n}\r\n","type FlattenedUUIDS = Map<ItemUUID, { uuid: ItemUUID; group: FeatGroup; index: number; exists: boolean }>\r\n\r\nconst UUIDS: Record<FeatGroup, ItemUUID[]> = {\r\n    scroll: [\r\n        'Compendium.pf2e.feats-srd.OqObuRB8oVSAEKFR',\r\n        'Compendium.pf2e.feats-srd.nWd7m0yRcIEVUy7O',\r\n        'Compendium.pf2e.feats-srd.LHjPTV5vP3MOsPPJ',\r\n    ],\r\n    talisman: ['Compendium.pf2e.feats-srd.ygCLN0brunmBYtJR', 'Compendium.pf2e.feats-srd.VO8HbMQ79NULE4FQ'],\r\n    trickster: [\r\n        'Compendium.pf2e.feats-srd.ROAUR1GhC19Pjk9C',\r\n        'Compendium.pf2e.feats-srd.UrOj9TROtn8nuxPf',\r\n        'Compendium.pf2e.feats-srd.lIg5Gzz7W70jfbk1',\r\n    ],\r\n    dabbler: ['Compendium.pf2e.feats-srd.1t5479E6bdvFs4E7', 'Compendium.pf2e.feats-srd.PTXZ2C3AV8tZf0iX'],\r\n}\r\n\r\nfunction flattenUUIDS(): FlattenedUUIDS {\r\n    const uuids = Object.entries(UUIDS).flatMap(([group, uuids]) => {\r\n        return uuids.map((x, i) => [x, { uuid: x, group: group as FeatGroup, index: i, exists: false }] as const)\r\n    })\r\n    return new Map(uuids)\r\n}\r\n\r\nfunction expandUUIDS(flatUUIDS: FlattenedUUIDS) {\r\n    const uuids = {} as Record<FeatGroup, boolean[]>\r\n    for (const entry of flatUUIDS.values()) {\r\n        uuids[entry.group] ??= []\r\n        uuids[entry.group][entry.index] = entry.exists\r\n    }\r\n    return uuids\r\n}\r\n\r\nexport function hasAllFeats(actor: CharacterPF2e) {\r\n    const uuids = flattenUUIDS()\r\n    actor.itemTypes.feat.forEach(feat => {\r\n        const sourceId = feat.getFlag('core', 'sourceId') as ItemUUID\r\n        const entry = uuids.get(sourceId)\r\n        if (entry) entry.exists = true\r\n    })\r\n    return expandUUIDS(uuids)\r\n}\r\n\r\nexport function hasAnyFeat(actor: CharacterPF2e, feats: FeatGroups) {\r\n    const uuids = feats.map(x => UUIDS[x[0]][x[1]])\r\n    return !!actor.itemTypes.feat.find(x => uuids.includes(x.getFlag('core', 'sourceId') as ItemUUID))\r\n}\r\n","import { localize } from './@utils/foundry/i18n'\r\nimport { fakeChatUUID } from './@utils/foundry/uuid'\r\n\r\nexport function isValidTalismanType(item: ItemPF2e | null): item is ConsumablePF2e {\r\n    if (!item || !item.isOfType('consumable')) return false\r\n    if (!item.traits.has('talisman')) return false\r\n    return true\r\n}\r\n\r\nexport function isValidSpellType(item: ItemPF2e | null): item is SpellPF2e {\r\n    if (!item || !item.isOfType('spell')) return false\r\n    if (item.isCantrip || item.isRitual) return false\r\n    return true\r\n}\r\n\r\nexport function createMessage(key: string, data: { uuid: ItemUUID; name: string }[], fakeLink = false) {\r\n    let msg = `<p>${localize(`app.message.${key}`)}</p>`\r\n    data.forEach(x => {\r\n        const name = x.name.endsWith(' **') ? x.name.slice(0, -3) : x.name\r\n        msg += fakeLink ? `<p>${fakeChatUUID(name)}</p>` : `<p>@UUID[${x.uuid}]{${name}}</p>`\r\n    })\r\n    return msg\r\n}\r\n","export function documentUuidFromTableResult(result: TableResult) {\r\n    if (result.type === CONST.TABLE_RESULT_TYPES.DOCUMENT) return `${result.documentCollection}.${result.documentId}`\r\n    if (result.type === CONST.TABLE_RESULT_TYPES.COMPENDIUM) return `Compendium.${result.documentCollection}.${result.documentId}`\r\n    return undefined\r\n}\r\n\r\nexport function chatUUID(uuid: string, name?: string) {\r\n    if (name) return `@UUID[${uuid}]{${name}}`\r\n    return `@UUID[${uuid}]`\r\n}\r\n\r\nexport function fakeChatUUID(name: string) {\r\n    return `<span style=\"background: #DDD;\r\n    padding: 1px 4px;\r\n    border: 1px solid var(--color-border-dark-tertiary);\r\n    border-radius: 2px;\r\n    white-space: nowrap;\r\n    word-break: break-all;\">${name}</span>`\r\n}\r\n","import { getFlag } from './@utils/foundry/flags'\r\nimport { registerUpstreamHook } from './@utils/foundry/hook'\r\nimport { subLocalize } from './@utils/foundry/i18n'\r\n\r\nconst localize = subLocalize('warning')\r\n\r\nexport function setWarning(enable: boolean) {\r\n    if (enable) {\r\n        registerUpstreamHook('dropCanvasData', onDropCanvasData)\r\n        registerUpstreamHook('dropActorSheetData', onDropActorSheetData)\r\n    } else {\r\n        Hooks.off('dropCanvasData', onDropCanvasData)\r\n        Hooks.off('dropActorSheetData', onDropActorSheetData)\r\n    }\r\n}\r\n\r\nfunction onDropCanvasData(canvas: Canvas, data: DropCanvasData) {\r\n    checkForWarning(data)\r\n}\r\n\r\nfunction onDropActorSheetData(target: ActorPF2e, targetSheet: ActorSheetPF2e, data: DropData) {\r\n    if (data.actorId === target.id) return\r\n    checkForWarning(data)\r\n}\r\n\r\nfunction checkForWarning(data: { uuid?: string; type?: string }) {\r\n    if (data.type !== 'Item' || !data.uuid) return\r\n\r\n    const item = fromUuidSync(data.uuid) as ItemPF2e\r\n    if (!item || !getFlag<boolean>(item, 'temporary')) return\r\n\r\n    const content = `<p class=\"dailies-center\">${localize('message')}</p>`\r\n    Dialog.prompt({\r\n        title: localize('title'),\r\n        label: localize('label'),\r\n        content,\r\n        rejectClose: false,\r\n        options: { width: 320 },\r\n    })\r\n}\r\n","export function registerUpstreamHook(hook: string, fn: (...args: any) => void) {\r\n    const id = Hooks.on(hook, fn)\r\n    const index = Hooks.events[hook].findIndex(x => x.id === id)\r\n    if (index !== 0) {\r\n        const [hooked] = Hooks.events[hook].splice(index, 1)\r\n        Hooks.events[hook].unshift(hooked)\r\n    }\r\n}\r\n"],"names":[],"version":3,"file":"main.js.map"}